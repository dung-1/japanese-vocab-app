<div class="quiz-container">
    <div *ngIf="!quizStarted" class="quiz-intro">
      <div class="quiz-settings">
        <label for="questionCount">S·ªë l∆∞·ª£ng c√¢u h·ªèi:</label>
        <select id="questionCount" [(ngModel)]="totalQuestions">
          <option value="5">5 c√¢u</option>
          <option value="10">10 c√¢u</option>
          <option value="15">15 c√¢u</option>
          <option value="20">20 c√¢u</option>
        </select>
      </div>
      <button class="start-btn" [disabled]="vocabData.length === 0" (click)="startQuiz()">
        {{ vocabData.length === 0 ? 'Vui l√≤ng ch·ªçn b√†i h·ªçc tr∆∞·ªõc' : 'B·∫Øt ƒë·∫ßu ki·ªÉm tra' }}
      </button>
    </div>
  
    <div *ngIf="quizStarted && !showResult" class="quiz-question">
      <div class="progress-bar">
        <div class="progress" [style.width.%]="(currentQuestionIndex + 1) / quizQuestions.length * 100"></div>
      </div>
      <div class="question-info">
        <span class="question-number">C√¢u h·ªèi {{ currentQuestionIndex + 1 }}/{{ quizQuestions.length }}</span>
      </div>
      
      <h3>{{ getCurrentQuestion().question }}</h3>
      
      <div class="options">
        <div *ngFor="let option of getCurrentQuestion().options" 
             class="option" 
             [class.selected]="selectedOption === option"
             [class.correct]="isCorrectOption(option)"
             [class.wrong]="isWrongOption(option)"
             (click)="selectOption(option)">
          <span *ngIf="getCurrentQuestion().type === 'meaning-to-radical'" class="radical-option">{{ option }}</span>
          <span *ngIf="getCurrentQuestion().type === 'radical-to-meaning'">{{ option }}</span>
        </div>
      </div>
      
      <div *ngIf="selectedOption" class="answer-feedback">
        <p *ngIf="selectedOption === getCurrentQuestion().correctAnswer" class="correct-feedback">
          Ch√≠nh x√°c! üëç
        </p>
        <p *ngIf="selectedOption !== getCurrentQuestion().correctAnswer" class="wrong-feedback">
          Sai r·ªìi! ƒê√°p √°n ƒë√∫ng l√†: 
          <span *ngIf="getCurrentQuestion().type === 'meaning-to-radical'" class="radical-answer">
            {{ getCurrentQuestion().correctAnswer }}
          </span>
          <span *ngIf="getCurrentQuestion().type === 'radical-to-meaning'">
            {{ getCurrentQuestion().correctAnswer }}
          </span>
        </p>
      </div>
      
      <button *ngIf="selectedOption" class="next-btn" (click)="nextQuestion()">
        {{ currentQuestionIndex < quizQuestions.length - 1 ? 'C√¢u ti·∫øp theo' : 'Xem k·∫øt qu·∫£' }}
      </button>
    </div>
  
    <div *ngIf="showResult" class="quiz-result">
      <h2>K·∫øt qu·∫£ ki·ªÉm tra</h2>
      <div class="result-score">
        <div class="score-circle" [ngClass]="{'excellent': correctAnswers/quizQuestions.length >= 0.8, 
                                              'good': correctAnswers/quizQuestions.length >= 0.6 && correctAnswers/quizQuestions.length < 0.8,
                                              'average': correctAnswers/quizQuestions.length < 0.6}">
          {{ correctAnswers }}/{{ quizQuestions.length }}
        </div>
        <p class="score-text">
          {{ (correctAnswers / quizQuestions.length) | percent }} ch√≠nh x√°c
        </p>
        <p class="score-message">
          <span *ngIf="correctAnswers/quizQuestions.length >= 0.8">Xu·∫•t s·∫Øc! B·∫°n ƒë√£ n·∫Øm v·ªØng c√°c b·ªô th·ªß.</span>
          <span *ngIf="correctAnswers/quizQuestions.length >= 0.6 && correctAnswers/quizQuestions.length < 0.8">T·ªët! B·∫°n ƒë√£ hi·ªÉu ƒë∆∞·ª£c ph·∫ßn l·ªõn c√°c b·ªô th·ªß.</span>
          <span *ngIf="correctAnswers/quizQuestions.length < 0.6">H√£y √¥n t·∫≠p th√™m ƒë·ªÉ n·∫Øm v·ªØng c√°c b·ªô th·ªß nh√©!</span>
        </p>
      </div>
      <div class="result-actions">
        <button class="retry-btn" (click)="generateQuizQuestions()">L√†m l·∫°i</button>
        <button class="new-quiz-btn" (click)="resetQuiz()">T·∫°o b√†i ki·ªÉm tra m·ªõi</button>
      </div>
    </div>
  </div>